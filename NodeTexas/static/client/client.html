<!DOCTYPE html>
<html>

	<head>
		<meta http-equiv="content-type"/>
		<meta charset="UTF-8">
		<link rel="icon" href="//localhost:8080/favicon.icon" type="image/x-icon" />
		<title></title>
	</head>

	<body>
		<button _method='get' class="btn_get">get</button>
		<button class="btn_post">post</button>
		<button class="btn_put">put</button>
		<button class="btn_delete">delete</button>
		<fieldset >
			<legend>框框</legend>
			<input type="text" name="uid" id="user_uid" value="" placeholder="account"/>
			<input type="password" name="pwd" id="user_pwd" value=""  placeholder="password"/>
			<button class="signUp" >注册</button>
			<button class="login"  >登录</button>
		</fieldset>
			
	</body>
	<script src="../ajax.js" type="text/javascript">
	</script>
	<!--自动登录-->
	<!--<script src="test_client.js" type="text/javascript">
		
	</script>-->
	<script type="text/javascript">
		var $ = _ => document.querySelector(_)
		
		// 区分是否登录
		let _isLogin = document.cookie.isLogin
		ajax({
			url: '//localhost:8080/api/v1/login'
		}).then(r => {
			console.log('auto login:'+r)
		}).catch(r=>{
			console.log('error in auto login')
		})
		
		
		
		
		
		
		
		
		
		
		
		$('.btn_get').onclick = () => {
			ajax({
				url: '//localhost:8080/api/v1/player',
				data: {
					uid : 199
				}
			}).then(r => {
				console.log('get:' + r)
			})
		}
		$('.btn_post').onclick = () => {
			ajax({
				method: 'post',
				url: '//localhost:8080/api/v1/player',
				data: {
					uid: ~~(Math.random()*100)
				}
			}).then(r => {
				console.log('post:' + r)
			})
		}
		$('.btn_put').onclick = () => {
			ajax({
				method: 'put',
				url: '//localhost:8080/api/v1/player',
				data: {
					uid: 87,
					chip: -20
				}
			}).then(r => {
				console.log('put:' + r)
			})
		}
		$('.btn_delete').onclick = () => {
			ajax({
				method: 'delete',
				url: '//localhost:8080/api/v1/player',
				data: {
					uid: 199
				}
			}).then(r => {
				console.log('delet:' + r)
			})
		}
		
		$('.signUp').onclick = () => {
			let uid = $('#user_uid').value,
				pwd = $('#user_pwd').value
			ajax({
				method: 'post',
				url: '//localhost:8080/api/v1/signUp',
				data: {
					uid: uid,
					pwd: pwd
				}
			}).then(r => {
				console.log(uid,pwd)
				console.log('signUp:' + r)
			})
		}
		$('.login').onclick = () => {
			let uid = $('#user_uid').value,
				pwd = $('#user_pwd').value
			ajax({
				method: 'post',
				url: '//localhost:8080/api/v1/login',
				data: {
					uid: uid,
					pwd: pwd
				}
			}).then(r => {
				console.log('signUp:' + r)
			})
		}
		function addUser(num) {
			for(let i = 3; i > 0; i--) {
				ajax({
					method: 'post',
					url: '//localhost:8080/api/v1/player',
					data: {
						uid : ~~(Math.random() * 100),
						pwd : 'default'
					}
				}).then(r => {
					console.log('post:' + r)
				}).catch(err=>{
					console.error(err)
				})
			}
		}
	</script>

</html>